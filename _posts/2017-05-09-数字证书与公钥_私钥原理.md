---
layout: post
title: "数字证书与公钥，私钥原理"
date: 2017-05-11 
description: "数字证书与公钥，私钥原理"
tag: web安全
--- 



# 数字证书与公钥，私钥原理

---

### 公钥和私钥特点
> 1.在客户端和服务器的交互中，双方都会有一對用于加密的字符串，我们称为公钥和私钥。两者区别在于私钥要自己保护的，公钥可以随便公开。

> 2.公钥加密需私钥解密才可查看，私钥加密公钥解密查看查看

> 3.在使用上也不同，公钥用于加密和认证（识别回复者的身份，应用私钥是个人独有的，如果用了对方的公钥解密成功即可识别对方非身份）

###公钥和私钥的使用过程（A代表公钥；代表私钥）（s代表服务器，c代表客户端）
    
### 通讯数据加密
    加密过程：
    服务器端公钥和私钥:  As  Bs
    服务器端公钥和私钥:  Ac  Bc
    加密数据: data


 - 在服务器和客户端通讯之前，双方都会获得对方的公钥
 - 客户端给服务器端传输数据data，首先用对方的公钥As加密data。通过传输后，服务器端通过自己的私钥Bs解密密文,然后得到data。反之，服务器和客户端的加密通讯业如此
 
### 数据来源身份认证
如果服务器端给客户端回复，那么客户端怎么才能知道是合法的服务器给它回复呢？

    认证：
    服务器端公钥和私钥:  As  Bs
    服务器端公钥和私钥:  Ac  Bc
    加密数据: data
    

 1.服务器端回复data

 -  使用hash算法为data数据进行摘要，（hash能把任意长度的字符串提取为128bit的整数字符），获取到摘要。
 -  用自己的秘钥Bs对摘要数据加密，到为止，属于服务器自己的数字签名生成了。
 -  然后发送data和自己的数字签名

2.客户端收到明文data和数字签名后，可以得到两点信息

 - 合法性：用服务器的公钥As解密数字签名，成功则为合法服务器回复的，否则非法。只要用服务器发布的公钥解密成功的，就可以以此来识别服务器的身份。
 - 正确性：由于hash摘要技术的特点，被摘要的数据经过hash运算可以得到hash值（即解密后的摘要）,如果想反过来想得到data几乎不可能。所有客户端可以通过把data通过hash运算后是否与数字签名解密和的值相同了知道，data数据在传输过程中是否被篡改。


###数字证书

以上加密通讯存在以下问题：

    由于公钥是公开的，如果在服务器与客户端通讯的时候换掉一方的公钥，就可以伪造身份和另一方通讯了。
    
解决方法：通过第三方对公钥和公钥对应的用户信息进行绑定，能让双方在通讯的时候能识别对方的身份。数字证书（与CA机构颁发的）

CA机构在颁发证书的时候会对公钥和公钥主的身份进行绑定，为了确保证书不被篡改，权威机构对数字证书进行hash计算（指纹算法），生成摘要（指纹），使用自己的私钥对摘要进行数字签名，放到数字证书中。

转载请注明：[杨胜涛的博客](http://magicyst.github.io) » [点击阅读原文](http://magicyst.github.io/2017/05/数字证书与公钥，私钥原理/)   


